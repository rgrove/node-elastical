<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib&#x2F;client.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Client.html">Client</a></li>
            
                <li><a href="..&#x2F;classes/Index.html">Index</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/client.html">client</a></li>
            
                <li><a href="..&#x2F;modules/elastical.html">elastical</a></li>
            
                <li><a href="..&#x2F;modules/index.html">index</a></li>
            
                <li><a href="..&#x2F;modules/util.html">util</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: lib&#x2F;client.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
ElasticSearch client implementation.

@module elastical
@submodule client
**&#x2F;

var request = require(&#x27;request&#x27;).defaults({encoding: &#x27;utf8&#x27;}),
    util    = require(&#x27;.&#x2F;util&#x27;),
    Index = require(&#x27;.&#x2F;index&#x27;),
    encode = encodeURIComponent;

&#x2F;**
Creates a new Elastical client associated with the specified _host_. The client
uses ElasticSearch&#x27;s REST API to interact with the host, so connections are
established as needed and are not persistent.

@example

    &#x2F;&#x2F; Create a client that connects to http:&#x2F;&#x2F;127.0.0.1:9200
    var elastical = require(&#x27;elastical&#x27;),
        client    = new elastical.client();

@class Client
@param {String} [host=&quot;127.0.0.1&quot;] Hostname to connect to.
@param {Object} [options] Client options.
    @param {String} [options.auth] Username and password (delimited by a &quot;:&quot;) to
        pass to ElasticSearch using basic HTTP auth. If not specified, no
        authentication will be used. Be sure to set &#x60;options.protocol&#x60; to
        &#x27;https&#x27; unless you&#x27;re comfortable sending passwords in plaintext.
    @param {Boolean} [options.curlDebug=false] If &#x60;true&#x60;, runnable curl commands
        will be written to stderr for every request the client makes. This is
        useful for debugging requests by hand.
    @param {Number} [options.port=9200] Port to connect to.
    @param {String} [options.protocol=&#x27;http&#x27;] Protocol to use. May be &quot;http&quot; or
        &quot;https&quot;.
    @param {String} [options.basePath=&#x27;&#x27;] Optional base path to prepend to all 
        query paths. This can be useful if acessing a cluster on a host that 
        uses paths to namespace customer indexes.
    @param {Number} [options.timeout=60000] Number of milliseconds to wait
        before aborting a request. Be sure to increase this if you do large bulk
        operations.
@constructor
**&#x2F;
function Client(host, options) {
    &#x2F;&#x2F; Allow options without host.
    if (typeof host === &#x27;object&#x27;) {
        options = host;
        host    = undefined;
    }

    this.host    = host || &#x27;127.0.0.1&#x27;;
    this.options = options || {};

    if(typeof this.options.port === &#x27;undefined&#x27;) {
      this.options.port = 9200;
    }
    else if(this.options.port === null) {
      this.options.port = null;
    }
    this.options.protocol || (this.options.protocol = &#x27;http&#x27;);
    this.options.timeout || (this.options.timeout = 60000);
    this.options.basePath || (this.options.basePath = null);

    this._indexCache = {};
}

Client.prototype = {
    &#x2F;&#x2F; -- Protected Properties -------------------------------------------------

    &#x2F;**
    Search options that must be passed as query parameters instead of in the
    request body.

    @property _SEARCH_PARAMS
    @type {String[]}
    @protected
    @final
    **&#x2F;
    _SEARCH_PARAMS: [
        &#x27;preference&#x27;, &#x27;routing&#x27;, &#x27;scroll&#x27;, &#x27;scroll_id&#x27;, &#x27;search_type&#x27;, &#x27;timeout&#x27;, &#x27;ignore_indices&#x27;
    ],

    &#x2F;&#x2F; -- Public Properties ----------------------------------------------------

    &#x2F;**
    Base URL for this client, of the form &quot;http:&#x2F;&#x2F;host:port&quot;.

    @property baseUrl
    @type {String}
    **&#x2F;
    get baseUrl() {
        var baseUrl = this.options.protocol + &#x27;:&#x2F;&#x2F;&#x27; +
            (this.options.auth ? this.options.auth + &#x27;@&#x27; : &#x27;&#x27;) +
            this.host;

        if(this.options.port !== null) {
          baseUrl = baseUrl + &#x27;:&#x27; + this.options.port;
        }

        if(this.options.basePath !== null) {
          baseUrl = baseUrl + this.options.basePath;
        }
        
        return baseUrl;
    },

    &#x2F;**
    Port number for this client.

    @property port
    @type {Number}
    **&#x2F;
    get port() {
        return this.options.port;
    },

    &#x2F;&#x2F; -- Public Methods -------------------------------------------------------

    &#x2F;**
    Performs multiple document create&#x2F;index&#x2F;delete operations in a single request.

    See &#x60;Index.bulk()&#x60; for detailed usage instructions.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;bulk.html)

    @example

        client.bulk([
            {create: {index: &#x27;blog&#x27;, type: &#x27;post&#x27;, id: &#x27;1&#x27;, data: {
                title: &#x27;Hello&#x27;,
                body : &#x27;Welcome to my stupid blog.&#x27;
            }}},

            {index: {index: &#x27;blog&#x27;, type: &#x27;post&#x27;, id: &#x27;2&#x27;, data: {
                title: &#x27;Breaking news&#x27;,
                body : &#x27;Today I ate a sandwich.&#x27;
            }}},

            {delete: {index: &#x27;blog&#x27;, type: &#x27;post&#x27;, id: &#x27;42&#x27;}}
        ], function (err, res) {
            &#x2F;&#x2F; ...
        });

    @method bulk
    @param {Object[]} operations Array of operations to perform. See
        &#x60;Index.bulk()&#x60; for a description of the expected object format.
    @param {Object} [options] Options. See &#x60;Index.bulk()&#x60; for details.
    @param {Function} [callback] Callback function.
        @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
        @param {Object} callback.res ElasticSearch response data.
    @see Index.bulk
    **&#x2F;
    bulk: wrapStaticIndexMethod(&#x27;bulk&#x27;),

    &#x2F;**
    Get the number of matches for a query

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;count.html)

    @method count
    @param {Object} options the options object
      @param {String} [options.index] Index name.
      @param {String} [options.type] type Type name.
      @param {String} [otions.query] Query to get the number of match for.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @static
    @see Index.count
    **&#x2F;
    count: function (options, callback) {
        var url   = &#x27;&#x27;,
            hasOptions;
        if (typeof options === &#x27;function&#x27;) {
            callback = options;
            options  = {};
        }
        if(typeof callback !== &#x27;function&#x27;){
          var err =  new Error(&quot;callback is not a function&quot;);
          var stack = err.stack;
          throw err;
        }

        &#x2F;&#x2F; Create a copy of options so we can modify it.
        options = util.merge(options || {});


        if (options.index) {
            url = &#x27;&#x2F;&#x27; + encode(Array.isArray(options.index) ?
                options.index.join(&#x27;,&#x27;) : options.index);

            delete options.index;
        }

        &#x2F;&#x2F; If a query is provided and it&#x27;s a string, automatically turn it into
        &#x2F;&#x2F; a query_string query.
        if (typeof options.query === &#x27;string&#x27;) {
            options = {query_string: {query: options.query}};
        }

        if (options.type) {
            if (!url) {
                url = &#x27;&#x2F;_all&#x27;;
            }

            url += &#x27;&#x2F;&#x27; + encode(Array.isArray(options.type) ?
                options.type.join(&#x27;,&#x27;) : options.type);

            delete options.type;
        }

        hasOptions = !!Object.keys(options).length;
        url += &#x27;&#x2F;_count&#x27;;
        options.curlDebug = true;
        var myOptions = { method: hasOptions ? &#x27;POST&#x27; : &#x27;GET&#x27;};
        if(hasOptions){
          myOptions.json = options;
        }
        this._request(url, myOptions, function (err, res) {
            if (err) { 
              return callback(err, null, res), undefined; 
            }
            if(res._shards.failed &gt; 0){
              return callback(new Error(res._shards.failures.reason), null, res), undefined;
            }
            return callback(null, res.count, res);
        });
    },

    &#x2F;**
    Creates a new index.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-create-index.html)

    @method createIndex
    @param {String} name Name of the new index.
    @param {Object} options Index options (see ElasticSearch docs for details).
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Index} callback.index Index instance for the newly created index.
      @param {Object} callback.data ElasticSearch response data.
    @see Index.create
    **&#x2F;
    createIndex: wrapStaticIndexMethod(&#x27;create&#x27;),

    &#x2F;**
    Deletes a document from the specified index. See &#x60;Index.delete()&#x60; for the
    complete list of supported options.

    @method delete
    @param {String} index Index name.
    @param {String} type Type name.
    @param {String} id Document id to delete.
    @param {Object} [options] Delete options.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response.
    @see Index.delete
    **&#x2F;
    delete: wrapIndexMethod(&#x27;delete&#x27;),

    &#x2F;**
    Deletes the specified index or indices. If no indices are specified, **all**
    indices on the server will be deleted.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-delete-index.html)

    @method deleteIndex
    @param {String|String[]} [names] Name of the index to delete, or an array of
        names to delete multiple indices. If omitted, **all** indices will be
        deleted.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.data ElasticSearch response data.
    @see Index.deleteIndex
    **&#x2F;
    deleteIndex: wrapStaticIndexMethod(&#x27;delete&#x27;),

    &#x2F;**
    Gets a document from the specified index based on its id.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;get.html)

    @method get
    @param {String} name Index name.
    @param {String} id Document id.
    @param {Object} [options] Options.
      @param {String|String[]} [options.fields] Document field name or array of
          field names to retrieve. By default, all fields are retrieved.
      @param {Boolean} [options.ignoreMissing=false] If &#x60;true&#x60;, an error will
          not be returned if the index, type, or document do not exist. Instead,
          a &#x60;null&#x60; document will be returned.
      @param {String} [options.preference] Controls which shard replicas the
          request should be executed on. By default, the operation will be
          randomized between the shard replicas. See the ElasticSearch docs for
          possible values.
      @param {Boolean} [options.realtime=true] Whether or not to use realtime
          GET. See the ElasticSearch docs for details.
      @param {Boolean} [options.refresh=false] If &#x60;true&#x60;, the relevant shard
          will be refreshed before the get operation to ensure that it&#x27;s
          searchable. This may cause heavy server load, so use with caution.
      @param {String} [options.routing] Value that determines what shard this
          document will be routed to. If not specified, a hash of the document&#x27;s
          id will be used. Note that an incorrectly routed get operation will
          fail, so it&#x27;s best to leave this alone unless you know your business.
      @param {String} [options.type=&quot;_all&quot;] If specified, the get operation will
          be limited to documents of this type.
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object|null} callback.doc Retrieved document or document fields,
          or &#x60;null&#x60; if the document was not found and &#x60;options.ignoreMissing&#x60; is
          &#x60;true&#x60;.
      @param {Object} callback.res Full ElasticSearch response data.
    @see Index.get
    **&#x2F;
    get: wrapIndexMethod(&#x27;get&#x27;),

    &#x2F;**
    Gets an Index instance for interacting with the specified ElasticSearch
    index.

    @example

        var client = new require(&#x27;elastical&#x27;).Client(),
            tweets = client.getIndex(&#x27;tweets&#x27;);

    @method getIndex
    @param {String} name Index name.
    @return {Index} Index instance.
    @see Index
    **&#x2F;
    getIndex: function (name) {
        return this._indexCache[name] ||
            (this._indexCache[name] = new Index(this, name));
    },

    &#x2F;**
    Gets mapping definitions for the specified type within the specified index.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-put-mapping.html)

    @method getMapping
    @param {String|String[]} names Index name or array of names.
    @param {String} type Document type. If omitted, mappings for all type are returned.
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @static
    @see Client.getMapping
    **&#x2F;
    getMapping: wrapStaticIndexMethod(&#x27;getMapping&#x27;),

    &#x2F;**
    Gets settings for the specified index&#x2F;indices.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-get-settings.html)

    @method getSettings
    @param {String|String[]} names Index name or array of names.
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @see Index.getSettings
    **&#x2F;
    getSettings: wrapStaticIndexMethod(&#x27;getSettings&#x27;),

    &#x2F;**
    Update settings for the specified index&#x2F;indices.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-update-settings&#x2F;)

    @method updateSettings
    @param {String|String[]} index Index name or array of names. If not specified,
        it will be applied to all indices
    @param {Object} settings Settings. See ElasticSearch docs for details.
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @see Index.updateSettings
    **&#x2F;
    updateSettings: wrapStaticIndexMethod(&#x27;updateSettings&#x27;),

    &#x2F;**
     Apply aliases actions.

     [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-aliases.html)

     @method applyAliasesActions
     @param {Object[]} actions Aliases actions.
     @param {Function} callback Callback function.
     @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
     @param {Object} callback.res ElasticSearch response data.
     @see Index.applyAliasesActions
     **&#x2F;
    applyAliasesActions: wrapStaticIndexMethod(&#x27;applyAliasesActions&#x27;),

    &#x2F;**
     Get aliases.

     [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-aliases.html)

     @method getAliases
     @param {String|String[]|null} names Index name or array of names.
     @param {Function} callback Callback function.
     @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
     @param {Object} callback.res ElasticSearch response data.
     @see Index.getAliases
     **&#x2F;
    getAliases: wrapStaticIndexMethod(&#x27;getAliases&#x27;),

&#x2F;**
    Adds a document to the specified index.

    If the specified index doesn&#x27;t exist, it will be created.

    If a document already exists in that index with the specified _type_ and
    _id_, it will be updated. Otherwise, a new document will be created.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;index_.html)

    @example

        client.index(&#x27;blog&#x27;, &#x27;post&#x27;, {
            title  : &quot;Welcome to my stupid blog&quot;,
            content: &quot;This is the first and last time I&#x27;ll post anything.&quot;,
            tags   : [&#x27;welcome&#x27;, &#x27;first post&#x27;, &#x27;last post&#x27;],
            created: Date.now()
        }, function (err, res) {
            if (err) { throw err; }
            console.log(&#x27;Indexed a blog post&#x27;);
        });

    @method index
    @param {String} index Index name.
    @param {String} type Document type.
    @param {Object} doc Document data to index.
    @param {Object} [options] Options.
      @param {String} [options.consistency=&quot;quorum&quot;] Write consistency to use
          for this indexing operation. Permitted values are &quot;one&quot;, &quot;quorum&quot; and
          &quot;all&quot;. See the ElasticSearch docs for details.
      @param {Boolean} [options.create=false] Only create the document if it
          doesn&#x27;t already exist.
      @param {String} [options.id] Document id. One will be automatically
          generated if not specified.
      @param {String} [options.parent] Parent document id.
      @param {String} [options.percolate] Percolation query to check against
          this document. See the ElasticSearch docs for details.
      @param {Boolean} [options.refresh=false] If &#x60;true&#x60;, the document will be
          made searchable immediately after it is indexed.
      @param {String} [options.replication=&quot;sync&quot;] Replication mode for this
          indexing operation. Maybe be set to &quot;sync&quot; or &quot;async&quot;.
      @param {String} [options.routing] Value that determines what shard this
          document will be routed to. If not specified, a hash of the document&#x27;s
          id will be used.
      @param {String} [options.timeout=&quot;1m&quot;] How long to wait for the primary
          shard to become available to index this document before aborting. See
          the ElasticSearch docs for details. This should be a value like &quot;5m&quot;
          (5 minutes) or &quot;15s&quot; (15 seconds).
      @param {Number} [options.version] Document version to create&#x2F;update. If
          this is set and &#x60;options.version_type&#x60; is not set,
          &#x60;options.version_type&#x60; will automatically be set to &quot;external&quot;.
      @param {String} [options.version_type=&quot;internal&quot;] Version type (either
          &quot;internal&quot; or &quot;external&quot;). See the ElasticSearch docs for details.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @see Index.index
    **&#x2F;
    index: wrapIndexMethod(&#x27;index&#x27;),

    &#x2F;**
    Checks whether the specified index or indices exist.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-indices-exists.html)

    @method indexExists
    @param {String|String[]} names Index name or array of names to check.
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Boolean} callback.exists &#x60;true&#x60; if all specified indices exist,
        &#x60;false&#x60; otherwise.
    @see Index.exists
    **&#x2F;
    indexExists: wrapStaticIndexMethod(&#x27;exists&#x27;),

    &#x2F;**
    Multi GET API allows to get multiple documents

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;multi-get.html)

    @method multiGet
    @param {String|null} index optional Index name.
    @param {String|null} type optional document type.
    @param {Object} data either docs or ids
      @param {Object[]} [data.docs] docs to query (can include _index, _type, _id, fields)
      @param {String[]} [data.ids] ids to query
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @see Index.multiGet
    **&#x2F;
    multiGet: wrapStaticIndexMethod(&#x27;multiGet&#x27;),

    &#x2F;**
    Registers a mapping definition for the specified type within the specified
    index or indices.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-put-mapping.html)

    @method putMapping
    @param {String|String[]} [names] Index name or array of names to define the
        mapping within. If not specified, it will be defined in all indices.
    @param {String} type Document type.
    @param {Object} [mapping] Mapping definition. See the [ElasticSearch
        docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;mapping&#x2F;) for
        an overview.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @static
    @see Client.putMapping
    **&#x2F;
    putMapping: wrapStaticIndexMethod(&#x27;putMapping&#x27;),

    &#x2F;**
    Refreshes the specified index or indices.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-refresh.html)

    @method refresh
    @param {String|String[]} [names] Index name or array of names to refresh. If
        not specified, all indices will be refreshed.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @see Index.refresh
    **&#x2F;
    refresh: wrapStaticIndexMethod(&#x27;refresh&#x27;),

    &#x2F;**
    Analyze

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-analyze.html)

    @method analyze
    @param {String} text Text to analyze
    @param {Object} [options] Options. See ElasticSearch docs for details.
        @param {String} [options.index=&quot;indexname&quot;] Specify indexname to use a specific
            index analyzer
        @param {String} [options.analyzer=&quot;standard&quot;] Analyzer to use for analysis
        @param {String} [options.tokenizer=&quot;keyword&quot;] Tokenizer to use for anaysis when
            using a custom transient anayzer
        @param {String} [options.field=&quot;obj1.field1&quot;] Use the analyzer configured in
            the mapping for this field
    @param {Function} [callback] Callback function.
        @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
        @param {Object} callback.res ElasticSearch response data.
    @static
    @see Index.analyze
    **&#x2F;

    analyze: wrapStaticIndexMethod(&#x27;analyze&#x27;),

    &#x2F;**
    Searches for documents matching the given query.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;)

    @example

        var client = new require(&#x27;elastical&#x27;).Client();

        client.search({query: &#x27;pie&#x27;}, function (err, results) {
            if (err) { throw err; }
            console.log(results);
        });

    @method search
    @param {Object} [options] Search options. Technically this argument is
        optional, but you&#x27;ll almost always want to provide at least a query.

      @param {Object|String} [options.query] Search query. This can be a simple
          string (in which case a &quot;query_string&quot; search will be performed) or a
          full query object. See the [ElasticSearch Query DSL docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;query-dsl&#x2F;)
          for details.
      @param {Boolean} [options.explain=false] If &#x60;true&#x60;, results will include
          an explanation of how the score was computed for each hit.
      @param {Object} [options.facets] Facets to aggregate by. See the
          [ElasticSearch facets docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;facets&#x2F;)
          for details.
      @param {String|String[]} [options.fields] Document field name or array of
          field names to retrieve. By default, all fields are retrieved.
      @param {Object} [options.filter] Result filter. See the [ElasticSearch
          filtering docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;filter.html)
          for details.
      @param {Number} [options.from=0] Return results starting at this offset.
      @param {Object} [options.highlight] Result highlighting options. See the
          [ElasticSearch highlighting docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;highlighting.html)
          for details.
      @param {String|String[]} [options.index] Index name or array of index
          names to search. By default all indices will be searched.
      @param {Object} [options.indices_boost] Index boost options. See the
          [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;index-boost.html)
          for details.
      @param {Number} [options.min_score] If specified, documents with a score
          lower than this will be filtered out.
      @param {String} [options.preference] Controls which shard replicas the
          request should be executed on. By default, the operation will be
          randomized between the shard replicas. See the [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;preference.html)
          for possible values.
      @param {String} [options.routing] Value that determines what shard this
          search will be routed to.
      @param {Object} [options.script_fields] Script expressions to evaluate for
          specific fields. See the [ElasticSearch script fields docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;script-fields.html)
          for details.
      @param {String} [options.scroll] Scroll timeout. If specified, nodes that
          participate in this search will maintain resources for this query
          until the timeout expires. See the [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;scroll.html)
          for details.
      @param {String} [options.scroll_id] Scroll id to use for this request.
      @param {String} [options.search_type] Search operation type to use. May be
          one of &quot;query_and_fetch&quot;, &quot;query_then_fetch&quot;, &quot;dfs_query_and_fetch&quot;,
          &quot;dfs_query_then_fetch&quot;, &quot;count&quot;, or &quot;scan&quot;. See the [ElasticSearch
          docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;search-type.html)
          for details.
      @param {Number} [options.size=10] Return this many results.
      @param {Object} [options.sort] Sort options. See the [ElasticSearch sort
          docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;search&#x2F;sort.html)
          for details.
      @param {String} [options.timeout] Timeout after which the search will be
          aborted. Any hits that have been gathered before the timeout is
          reached will be returned. Default is no timeout.
      @param {Boolean} [options.track_scores=false] Whether or not to compute
          scores when sorting by a field.
      @param {String|String[]} [options.type] Type name or array of type names
          to search. By default all types will be searched.
      @param {Boolean} [options.version=false] If &#x60;true&#x60;, a version number will
          be returned for each hit.

    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.results Search results.
      @param {Object} callback.res Full ElasticSearch response data.
    **&#x2F;
    search: function (options, callback) {
        var query = [],
            url   = &#x27;&#x27;,
            hasOptions;

        if (typeof options === &#x27;function&#x27;) {
            callback = options;
            options  = {};
        }
        var useScrollingEndpoint = (options.scroll_id != null);
        &#x2F;&#x2F; Create a copy of options so we can modify it.
        options = util.merge(options || {});

        &#x2F;&#x2F; Some options must be passed as query parameters. Find those options
        &#x2F;&#x2F; and move them into the query param array.
        this._SEARCH_PARAMS.forEach(function (name) {
            var value = options[name];

            if (typeof value !== &#x27;undefined&#x27;) {
                if (value === true || value === false) {
                    query.push(encode(name) + &#x27;=&#x27; + (value ? &#x27;1&#x27; : &#x27;0&#x27;));
                } else {
                    query.push(encode(name) + &#x27;=&#x27; + encode(value));
                }

                delete options[name];
            }
        });

        if (options.fields) {
            options.fields = Array.isArray(options.fields) ? options.fields :
                [options.fields];
        }

        if (options.index) {
            url = &#x27;&#x2F;&#x27; + encode(Array.isArray(options.index) ?
                options.index.join(&#x27;,&#x27;) : options.index);

            delete options.index;
        }

        &#x2F;&#x2F; If a query is provided and it&#x27;s a string, automatically turn it into
        &#x2F;&#x2F; a query_string query.
        if (typeof options.query === &#x27;string&#x27;) {
            options.query = {query_string: {query: options.query}};
        }

        if (options.type) {
            if (!url) {
                url = &#x27;&#x2F;_all&#x27;;
            }

            url += &#x27;&#x2F;&#x27; + encode(Array.isArray(options.type) ?
                options.type.join(&#x27;,&#x27;) : options.type);

            delete options.type;
        }

        hasOptions = !!Object.keys(options).length;

        url += &#x27;&#x2F;_search&#x27;;

        if(useScrollingEndpoint){
          url += &#x27;&#x2F;scroll&#x27;;
        }

        if (query.length) {
            url += &#x27;?&#x27; + query.join(&#x27;&amp;&#x27;);
        }

        this._request(url, {
            method: hasOptions ? &#x27;POST&#x27; : &#x27;GET&#x27;,
            json  : hasOptions ? options : {}
        }, function (err, res) {
            if (err) { return callback(err, null, res), undefined; }
            callback(null, res.hits, res);
        });
    },
    
    &#x2F;**
    Provide statistics on different operations happening on an index.
    By default, docs, store, and indexing, get, and search stats are returned.
    
    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;admin-indices-stats.html)

    @example

        var client = new require(&#x27;elastical&#x27;).Client();

        client.stat({index: &#x27;blog&#x27;}, function (err, results) {
            if (err) { throw err; }
            console.log(results);
        });

    @method stats
    @param {Object} [options] Stats options. Technically this argument is
        optional, but you&#x27;ll almost always want to provide at least an index.
      @param {String|String[]} [options.index] Index name or array of index
          names to display stats on. By default global stats will be displayed.
      @param (String|String[]) [options.types] Comma separated list of types to provide document type level stats.
      @param {Boolean} [options.docs=true] The number of docs &#x2F; deleted docs.
      @param {Boolean} [options.store=true] The size of the index.
      @param {Boolean} [options.indexing=true] Indexing statistics.
      @param {Boolean} [options.get=true] Get statistics, including missing stats.
      @param {Boolean} [options.search=true] Search statistics.
      @param {Boolean} [options.warmer=false] Warmer statistics.
      @param {Boolean} [options.merge=false] merge stats.
      @param {Boolean} [options.flush=false] flush stats.
      @param {Boolean} [options.refresh=false] refresh stats.
      @param {Boolean} [options.clear=false] Clears all the flags (first).
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    **&#x2F;
    stats: function (options, callback) {
      var query = [],
          url = &#x27;&#x27;,
          hasOptions;

      if (typeof options === &#x27;function&#x27;) {
        callback = options;
        options = {};
      }
      &#x2F;&#x2F;Create a copy of options so we can modify it.
      options = util.merge(options || {});

      if (options.index) {
        url = &#x27;&#x2F;&#x27; + encode(Array.isArray(options.index) ?
          options.index.join(&#x27;,&#x27;) : options.index);

        delete options.index;
        &#x2F;&#x2F;Look for types only if there is an index
        if (options.types) {
          query.push(encode(&#x27;types&#x27;) + &#x27;=&#x27; + encode(Array.isArray(options.types) ?
            options.types.join(&#x27;,&#x27;) : options.types));
        }
        delete options.types;
      }

      url += &#x27;&#x2F;_stats&#x27;;  

      util.each(options, function (value, name) {
          if (value === true || value === false) {
              value = value ? &#x27;1&#x27; : &#x27;0&#x27;;
          }

          query.push(encode(name) + &#x27;=&#x27; + encode(value));
      });
      
      if (query.length) {
        url += &#x27;?&#x27; + query.join(&#x27;&amp;&#x27;);
      }
      
      this._request(url, {
          method: &#x27;GET&#x27;
      }, function (err, res) {
        if(err) { return callback(err, null, res), undefined; }
        callback(null, res);
      });
    },
    
    &#x2F;&#x2F; TODO: percolate, delete by query, more like this
    &#x2F;**
    Registers a percolator for the given index or modifies the existing percolator
    if one with the name already exists

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;api&#x2F;pecolator&#x2F;)

    @example
        var put =   {
                        &quot;query&quot; : {
                            &quot;text&quot; : {
                                &quot;hashtags&quot; : {
                                    &quot;query&quot; : &#x27;blah blah blah &#x27;,
                                    &quot;operator&quot; : &quot;or&quot;
                                }
                            }
                        }
                    };
        client.percolator(&#x27;tweets&#x27;, &#x27;mypercolator&#x27;, query, function (err, res) {
            if (err) { throw err; }
            console.log(results);
        });
    @method setPercolator
    @param {String|String[]} index Index name or array of index
          names to register the percolator.
    @param {String} percolator The identifier string of the percolator.
            This identifier is returned when a document matches
            the query in the percolator, either through percolate operation or
            through index opertation.
    @param {Object|String} query Search query. Afull query object.
        See the [ElasticSearch Query DSL docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;query-dsl&#x2F;)
        for details.
    @param {Function} callback Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res Full ElasticSearch response data.
    *&#x2F;
    setPercolator: wrapIndexMethod(&#x27;setPercolator&#x27;),

    &#x2F;**
     * Retrieve the percolator doc
     *
     * @example
     *
     *  client.getPercolator(&#x27;tweets&#x27;, &#x27;mypercolator&#x27;, function (err, results) {
     *      if (err) { throw err; }
     *      console.log(results);
     *  });
     *
     *  @param {String} index  The index name to which the percolator is registered
     *  @param {String} percolator The name of the percolator
     *  @param {Function} callback Callback function.
     *      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
     *      @param {Object} callback.doc  Percolator document.
     *      @param {Object} callback.res Full ElasticSearch response data.
     *&#x2F;
    getPercolator: wrapIndexMethod(&#x27;getPercolator&#x27;),

    &#x2F;**
     * Test if a given doc matches a percolator for
     * the given index and document type
     * @example
     *      client.perolate(&#x27;tweets&#x27;, &#x27;tweet&#x27;, {}, function(err, res){
     *          if(err){ throw err; }
     *          console.log(res);
     *      });
     *  @param {String} index The index name to which the document should be
     *      checked for matching percolators
     *  @param {String} type The type name of the document
     *  @param {Object} doc The document object which the registered percolators
     *      are matched against
     *  @param {Function} callback Callback function.
     *      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
     *      @param {Object} callback.res Full ElasticSearch response data.
     *&#x2F;
    percolate: wrapIndexMethod(&#x27;percolate&#x27;),

    &#x2F;**
     * Delete a registered percolator for the given index or indicies
     * @example
     *      client.deletePercolator(&#x27;tweets&#x27;, &#x27;mypercolator&#x27;, function(err, res){
     *          if(err){ throw err;}
     *          console.log(res);
     *      });
     * @param {String|String[]} index Index name or array of index names
     * @param {String} percolator Name of the percolator to delete
     * @param {Function} callback Callback function.
     *      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
     *      @param {Object} callback.res Full ElasticSearch response data.
     *&#x2F;
    deletePercolator: wrapIndexMethod(&#x27;deletePercolator&#x27;),


    &#x2F;**
    Registers a river with the cluster.
    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;river&#x2F;)

    @method putRiver
    @param {String} name A name for this river.
    @param {Object} config The river configuration.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @static
    **&#x2F;
    putRiver: wrapIndexMethod(&#x27;putRiver&#x27;),

    &#x2F;**
    Gets river config from the cluster.
    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;river&#x2F;)

    @method getRiver
    @param {Client} client Client instance.
    @param {String} name A name for this river.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @static
    **&#x2F;
    getRiver: wrapIndexMethod(&#x27;getRiver&#x27;),

    &#x2F;**
    Deletes a river config from the cluster.

    [ElasticSearch docs](http:&#x2F;&#x2F;www.elasticsearch.org&#x2F;guide&#x2F;reference&#x2F;river&#x2F;)

    @method deleteRiver
    @param {Client} client Client instance.
    @param {String} name A name for this river.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object} callback.res ElasticSearch response data.
    @static
    **&#x2F;
    deleteRiver: wrapIndexMethod(&#x27;deleteRiver&#x27;),

    &#x2F;&#x2F; -- Protected Methods ----------------------------------------------------

    &#x2F;**
    Makes an HTTP request using the &#x60;request&#x60; module.

    @method _request
    @param {String} path Request path.
    @param {Object} [options] Request options.
    @param {Function} [callback] Callback function.
      @param {Error|null} callback.err Error, or &#x60;null&#x60; on success.
      @param {Object|Buffer|String} callback.body Response body (parsed as JSON
          if possible).
    @protected
    **&#x2F;
    _request: function (path, options, callback) {
        var url = this.baseUrl + path;

        if (typeof options === &#x27;function&#x27;) {
            callback = options;
            options  = {};
        }

        &#x2F;&#x2F; Callback is optional.
        callback || (callback = noop);

        options = util.merge(options);
        options.uri = url;

        [ &#x27;timeout&#x27;,
          &#x27;pool&#x27;,
          &#x27;agent&#x27;,
          &#x27;headers&#x27;,
          &#x27;followRedirect&#x27;,
          &#x27;followAllRedirects&#x27;,
          &#x27;proxy&#x27;,
          &#x27;oauth&#x27;,
          &#x27;strictSSL&#x27;,
          &#x27;jar&#x27;].forEach(function(key){
          if(this.options[key] == null) return
          options[key] || (options[key] = this.options[key]);
        }, this);

        &#x2F;&#x2F; Write executable curl commands to stderr for easier debugging when
        &#x2F;&#x2F; this client&#x27;s curlDebug option is true.
        if (this.options.curlDebug) {
            curlDebug(options);
        }

        &#x2F;&#x2F; Provide a testing hook to allow inspection of the request options
        &#x2F;&#x2F; without actually sending a request.
        if (this._testHook) {
            return this._testHook(null, options), undefined;
        }
        request(url, options, function (err, res, body) {
            if (err) { return callback(err), undefined; }

            &#x2F;&#x2F; The request module will automatically try to parse the
            &#x2F;&#x2F; response as JSON if &#x60;options.json&#x60; is truthy and the response
            &#x2F;&#x2F; has an application&#x2F;json content-type, but it currently fails
            &#x2F;&#x2F; on content-types with charset suffixes, so it can&#x27;t be relied
            &#x2F;&#x2F; upon.
            &#x2F;&#x2F;
            &#x2F;&#x2F; See https:&#x2F;&#x2F;github.com&#x2F;mikeal&#x2F;request&#x2F;commit&#x2F;68c17f6c9a3d7217368b3b8bc61203e6a14eb4f0
            if (typeof body === &#x27;string&#x27; || body instanceof Buffer) {
                body = body.toString(&#x27;utf8&#x27;);

                try {
                    body = JSON.parse(body);
                } catch (ex) {}
            }

            if (res.statusCode &lt; 200 || res.statusCode &gt; 299) {
                callback(Error((body &amp;&amp; body.error) || &#x27;HTTP &#x27; + res.statusCode),
                    body || {});
                return;
            }

            callback(null, body || {});
            return;
        });
    }
};

&#x2F;**
Alias for index().

@method set
@see index
**&#x2F;
Client.prototype.set = Client.prototype.index;

module.exports = Client;

&#x2F;&#x2F; -- Private Functions --------------------------------------------------------
function noop() {}

function curlDebug(options) {
    var command = &#x27;curl -X&#x27; + (options.method || &#x27;GET&#x27;);

    command += &quot; &#x27;&quot; + options.uri + &quot;&#x27;&quot;;

    if (options.body) {
        command += &quot; --data-binary &#x27;&quot; + options.body + &quot;&#x27;&quot;;
    } else if (options.json) {
        command += &quot; -d &#x27;&quot; + JSON.stringify(options.json, null, 2) + &quot;&#x27;&quot;;
    }

    process.stdout.write(command + &#x27;\n&#x27;);
}

function wrapIndexMethod(methodName) {
    return function (indexName) {
        var args  = Array.prototype.slice.call(arguments, 1),
            index = this.getIndex(indexName);

        return index[methodName].apply(index, args);
    };
}

function wrapStaticIndexMethod(methodName) {
    return function () {
        var args = Array.prototype.slice.call(arguments);

        args.unshift(this);
        return Index[methodName].apply(Index, args);
    }
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
